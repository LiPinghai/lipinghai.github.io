---
layout: default
title: 《SQL必知必会》读书笔记(3)
categories: [tech]
tags: [reading-note]
excerpt: 《SQL必知必会》读书笔记。适合新手迅速自学SQL知识。

---
# 《SQL必知必会》读书笔记(3)

## 插入数据

```SQL
INSERT INTO Customers
VALUE('10000',
    'Tom',
    'New York',
    'USA'
    )
```
更安全的完整写法：
```SQL
INSERT INTO Customers(cust_id,
                    cust_name,
                    cust_cify,
                    cust_country)
VALUE('10000',
    'Tom',
    'New York',
    'USA'
    )
```

### 复制一张表

```SQL
SELECT *
INTO CustCopy
FROM Customers
```
MySQL语法
```SQL
CREATE TABLE CustCopy AS
SELECT * FROM Customers
```

## 更新和删除

### 更新
`UPDATE`
```SQL
UPDATE Customers
SET cust_contact = 'Sam Roberts',
    cust_email = 'sam@toyland.com'
WHERE cust_id = '1000';
```

### 删除
`DELETE`
```SQL
DELETE FROM Customers
WHERE cust_id = '1000';
```
如果要快速删除，可以用`TRUNCATE TABLE`

## 创建和操纵表

### 创建表

```SQL
CREATE TABLE Products
(
    prod_id     CHAR(10)        NOT NULL,
    vend_id     CHAR(10)        NOT NULL,
    prod_name   CHAR(254)       NOT NULL,
    prod_price  DECIMAL(8,2)    NOT NULL    DEFAULT 1,
    prod_desc   VARCHAR(1000)   NULL
);
```

### 更新表

`ALTER TABLE`
增加字段
```SQL
ALTER TABLE Vendors
ADD vend_phone CHAR(20);
```

### 删除字段
很多DBMS不支持删除字段
```SQL
ALTER TABLE Vendors
DROP COLUMN vend_phone;
```

### 删除表
```SQL
DROP TABLE CustCopy;
```

### 重命名表
各DBMS实现不同, `RENAME`或 `ALTER TABLE`。

## 使用视图

视图就是虚拟表，就是查询的封装。

### 创建视图

`CREATE VIEW`

```SQL
CREATE VIEW ProductCustomers AS
SELECT cust_name, cust_contact, prod_id
FROM Customers, Orders, OrderItems
WHERE Customers.cust_id = Order.cust_id
    AND OrderItems.order_num = Orders.order_num;
```
使用上述视图
```SQL
SELECT cust_name, cust_contact
FROM ProductCustomers
WHERE prod_id = 'RGAN01';
```

用视图来格式化查询
```SQL
CREATE VIEW VendorLocations AS
SELECT RTRIM(vend_name) + '(' + RTRIM(vend_country) + ')'
    AS vend_title
FROM Vendors;
```

用视图来过滤数据
```SQL
CREATE VIEW CustomerEMailList AS
SELECT cust_id, cust_name, cust_email
FROM Customers
WHERE cust_email IS NOT NULL;
```

使用视图输出计算字段
```SQL
CREATE VIEW OrderItemsExpanded AS
SELECT prod_price,
        quantity,
        item_price,
        quantity*item_price AS expanded_price
FROM OrdeItems
WHERE order_num = 10086;
```
